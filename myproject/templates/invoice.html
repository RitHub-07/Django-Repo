{% load static %}
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Flippkart Invoice #{{ order.id }}</title>
    <style type="text/css">
        body, table, td, a { 
            -webkit-text-size-adjust: 100%; 
            -ms-text-size-adjust: 100%; 
            font-family: 'Segoe UI', Roboto, -apple-system, sans-serif;
        }
        table, td { mso-table-lspace: 0pt; mso-table-rspace: 0pt; }
        :root {
            --primary: #2563eb;
            --primary-dark: #1e40af;
            --success: #10b981;
            --light-bg: #f8fafc;
            --card-bg: #ffffff;
            --dark-text: #1e293b;
            --medium-text: #64748b;
            --border-color: #e2e8f0;
        }
    </style>
</head>
<body style="margin: 0; padding: 0; background-color: var(--light-bg);">

<table border="0" cellpadding="0" cellspacing="0" width="100%">
    <tr>
        <td align="center" valign="top">
            <table border="0" cellpadding="0" cellspacing="0" width="650" style="border-collapse: collapse; box-shadow: 0 1px 3px rgba(0,0,0,0.1);">
                <!-- Header -->
                <tr>
                    <td style="padding: 30px 0; background: linear-gradient(135deg, var(--primary), var(--primary-dark)); text-align: center;">
                        <h1 style="color: white; margin: 0; font-size: 24px; font-weight: 600;">FLIPPKART</h1>
                        <p style="color: rgba(255,255,255,0.9); margin: 8px 0 0 0; font-size: 16px;">
                            Order Invoice #{{ order.id }}
                        </p>
                    </td>
                </tr>
                
                <!-- Status -->
                <tr>
                    <td style="background-color: var(--success); color: white; padding: 12px 30px; font-size: 15px; text-align: center;">
                        ✓ Order Confirmed • Delivery by {{ expected_delivery|date:"F j" }}
                    </td>
                </tr>
                
                <!-- Customer Info -->
                <tr>
                    <td style="background-color: var(--card-bg); padding: 30px;">
                        <table width="100%">
                            <tr>
                                <td width="50%" style="vertical-align: top; padding-right: 15px;">
                                    <h3 style="color: var(--primary); margin: 0 0 10px 0; font-size: 16px;">CUSTOMER DETAILS</h3>
                                    <p style="margin: 0; color: var(--dark-text); line-height: 1.5;">
                                        <strong>{{ order.name }}</strong><br>
                                        {{ order.email }}<br>
                                        {{ order.phone }}
                                    </p>
                                </td>
                                <td width="50%" style="vertical-align: top; padding-left: 15px;">
                                    <h3 style="color: var(--primary); margin: 0 0 10px 0; font-size: 16px;">SHIPPING ADDRESS</h3>
                                    <p style="margin: 0; color: var(--dark-text); line-height: 1.5;">
                                        {{ order.address }}<br>
                                        {{ order.city }}, {{ order.pincode }}<br>
                                        India
                                    </p>
                                </td>
                            </tr>
                        </table>
                    </td>
                </tr>
                
                <!-- Order Items -->
                <tr>
                    <td style="background-color: var(--card-bg); padding: 0 30px;">
                        <table width="100%" style="border-collapse: collapse;">
                            <tr style="background-color: #f8fafc; border-bottom: 2px solid var(--border-color);">
                                <th style="padding: 15px; text-align: left; width: 45%;">PRODUCT</th>
                                <th style="padding: 15px; text-align: right; width: 15%;">PRICE</th>
                                <th style="padding: 15px; text-align: center; width: 15%;">QTY</th>
                                <th style="padding: 15px; text-align: right; width: 25%;">TOTAL</th>
                            </tr>
                            {% for item in order.orderitem_set.all %}
                            <tr style="border-bottom: 1px solid var(--border-color);">
                                <!-- Product Column with Image -->
                                <td style="padding: 15px; vertical-align: middle;">
                                    <table>
                                        <tr>
                                            <td style="padding-right: 15px; vertical-align: middle;">
                                                <div style="width: 60px; height: 60px; background-color: #f1f5f9; display: flex; align-items: center; justify-content: center; border-radius: 4px;">
                                                    <img src="{{ item.product.image_url }}" width="60" style="max-width: 60px; max-height: 60px; object-fit: contain;" alt="{{ item.product.name }}">
                                                </div>
                                            </td>
                                            <td style="vertical-align: middle;">
                                                <div style="font-weight: 500;">{{ item.product.name }}</div>
                                                <div style="color: var(--medium-text); font-size: 13px; margin-top: 4px;">
                                                    SKU: {{ item.product.sku|default:"N/A" }}
                                                </div>
                                            </td>
                                        </tr>
                                    </table>
                                </td>
                                <!-- Price -->
                                <td style="padding: 15px; text-align: right; vertical-align: middle; font-weight: 500;">
                                    ₹{{ item.price }}
                                </td>
                                <!-- Quantity -->
                                <td style="padding: 15px; text-align: center; vertical-align: middle;">
                                    {{ item.quantity }}
                                </td>
                                <!-- Total -->
                                <td style="padding: 15px; text-align: right; vertical-align: middle; font-weight: 600;">
                                    ₹{{ item.total_price }}
                                </td>
                            </tr>
                            {% endfor %}
                        </table>
                    </td>
                </tr>
                
                <!-- Order Summary -->
                <tr>
                    <td style="background-color: var(--card-bg); padding: 30px;">
                        <table width="100%">
                            <tr>
                                <td width="60%">
                                    <div style="background-color: #f8fafc; padding: 20px; border-radius: 8px;">
                                        <h3 style="color: var(--primary); margin: 0 0 10px 0; font-size: 16px;">DELIVERY INFO</h3>
                                        <p style="margin: 0; color: var(--medium-text);">
                                            Standard Delivery • 3-5 business days<br>
                                            Tracking #FLPK{{ order.id|stringformat:"08d" }}
                                        </p>
                                    </div>
                                </td>
                                <td width="40%">
                                    <div style="background-color: #f8fafc; padding: 20px; border-radius: 8px;">
                                        <table width="100%">
                                            <tr>
                                                <td style="padding: 6px 0; color: var(--medium-text);">Subtotal:</td>
                                                <td style="padding: 6px 0; text-align: right; color: var(--medium-text);">₹{{ order.total_amount }}</td>
                                            </tr>
                                            <tr>
                                                <td style="padding: 6px 0; color: var(--medium-text);">Shipping:</td>
                                                <td style="padding: 6px 0; text-align: right; color: var(--success);">FREE</td>
                                            </tr>
                                            <tr>
                                                <td style="padding: 12px 0; border-top: 1px solid var(--border-color); font-weight: 600;">Total:</td>
                                                <td style="padding: 12px 0; border-top: 1px solid var(--border-color); text-align: right; font-weight: 700; font-size: 18px;">₹{{ order.total_amount }}</td>
                                            </tr>
                                        </table>
                                    </div>
                                </td>
                            </tr>
                        </table>
                    </td>
                </tr>
                
                <!-- Footer -->
                <tr>
                    <td style="background-color: var(--primary-dark); color: white; padding: 25px; text-align: center;">
                        <p style="margin: 0 0 10px 0; font-size: 14px;">Thank you for shopping with Flippkart</p>
                        <p style="margin: 0; font-size: 13px; opacity: 0.8;">
                            © {% now "Y" %} Flippkart. All Rights Reserved.
                        </p>
                    </td>
                </tr>
            </table>
        </td>
    </tr>
</table>
</body>
</html>